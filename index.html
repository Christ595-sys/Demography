<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lebanon ‚Äî Conflict Impact Summary</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#9aa8b6;
      --accent1:#6ee7b7;
      --accent2:#60a5fa;
      --accent3:#c084fc;
      --accent4:#f87171;
      --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.02);
      --glass-border: rgba(255,255,255,0.06);
      --radius: 16px;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg) 0%, #071024 100%);color:#e6eef6}
    .container{max-width:1100px;margin:48px auto;padding:28px}

    header{display:flex;align-items:center;justify-content:space-between;gap:18px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:grid;place-items:center;font-weight:800;color:#012;padding:6px;font-size:18px}
    h1{margin:0;font-size:24px;letter-spacing:-0.3px}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:18px;margin-top:22px}

    /* Stats */
    .stats{grid-column:1 / span 5;padding:18px;background:linear-gradient(180deg,var(--glass),var(--glass-2));border:1px solid var(--glass-border);border-radius:var(--radius)}
    .stat{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px dashed rgba(255,255,255,0.03)}
    .stat:last-child{border-bottom:0}
    .stat .num{font-size:20px;font-weight:700}
    .stat .label{color:var(--muted);font-size:13px}

    .chart{grid-column:6 / span 7;padding:20px;border-radius:var(--radius);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
    .timeline{display:flex;flex-direction:column;gap:14px}
    .time-card{padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(255,255,255,0.015), transparent);border:1px solid rgba(255,255,255,0.02)}
    .time-card h3{margin:0;font-size:15px}
    .time-card p{margin:6px 0 0;color:var(--muted);font-size:13px}

    /* Sections */
    .sections{grid-column:1 / span 12;margin-top:18px;display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.03)}
    .card h4{margin:0 0 8px}
    .card ul{margin:0;padding-left:18px;color:var(--muted)}

    /* big stat banner */
    .hero-stat{grid-column:1 / span 12;display:flex;align-items:center;justify-content:space-between;padding:18px;border-radius:14px;background:linear-gradient(90deg, rgba(96,165,250,0.08), rgba(110,231,183,0.05));border:1px solid rgba(255,255,255,0.03);margin-top:14px}
    .hero-stat .big{font-size:28px;font-weight:800}
    .hero-stat .sub{color:var(--muted);font-size:13px}

    /* NEW: Death Rates Section */
    .death-rates {
      grid-column: 1 / span 12;
      margin-top: 24px;
      padding: 24px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(248, 113, 113, 0.05), rgba(248, 113, 113, 0.02));
      border: 1px solid rgba(248, 113, 113, 0.1);
      position: relative;
      overflow: hidden;
    }
    .death-rates::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent4), transparent);
    }
    .death-rates h2 {
      margin: 0 0 20px 0;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .death-rates h2::before {
      content: '‚ö∞Ô∏è';
      font-size: 18px;
    }
    
    /* Death Summary Cards */
    .death-summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .death-summary-card {
      padding: 20px;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.05);
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .death-summary-card.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .death-summary-card:hover {
      transform: translateY(-5px);
      background: rgba(248, 113, 113, 0.08);
      border-color: rgba(248, 113, 113, 0.2);
    }
    .death-summary-card h3 {
      margin: 0 0 12px 0;
      font-size: 16px;
      color: var(--accent4);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .death-summary-card h3::before {
      content: '‚ñ∏';
      font-size: 12px;
    }
    .death-summary-card p {
      margin: 0;
      font-size: 13px;
      line-height: 1.5;
      color: rgba(255, 255, 255, 0.8);
    }
    
    /* Death Stats Cards */
    .death-stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .death-stat-card {
      padding: 18px;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.05);
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .death-stat-card.visible {
      opacity: 1;
      transform: translateX(0);
    }
    .death-stat-card:hover {
      transform: translateY(-5px);
      background: rgba(248, 113, 113, 0.08);
      border-color: rgba(248, 113, 113, 0.2);
    }
    .death-stat-value {
      font-size: 32px;
      font-weight: 800;
      background: linear-gradient(90deg, var(--accent4), #fca5a5);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 6px;
      line-height: 1;
    }
    .death-stat-label {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .death-stat-desc {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.4;
    }
    
    /* Key Statistics Grid */
    .key-stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 14px;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }
    .key-stat {
      text-align: center;
      padding: 14px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.02);
      opacity: 0;
      transform: scale(0.9);
      transition: all 0.5s ease-out;
    }
    .key-stat.visible {
      opacity: 1;
      transform: scale(1);
    }
    .key-stat-value {
      font-size: 26px;
      font-weight: 800;
      color: var(--accent4);
      margin-bottom: 4px;
    }
    .key-stat-label {
      font-size: 12px;
      color: var(--muted);
    }
    
    /* Timeline Section */
    .death-timeline {
      margin-top: 30px;
      padding: 20px;
      background: rgba(0, 0, 0, 0.15);
      border-radius: 10px;
      border-left: 3px solid var(--accent4);
    }
    .death-timeline h3 {
      margin: 0 0 16px 0;
      color: var(--accent4);
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .death-timeline h3::before {
      content: 'üìÖ';
      font-size: 14px;
    }
    .timeline-item {
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.05);
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.5s ease-out;
    }
    .timeline-item:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    .timeline-item.visible {
      opacity: 1;
      transform: translateX(0);
    }
    .timeline-date {
      font-size: 12px;
      color: var(--accent4);
      font-weight: 600;
      margin-bottom: 4px;
    }
    .timeline-desc {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.4;
    }
    
    /* Civilian Impact Highlight */
    .civilian-impact {
      margin-top: 20px;
      padding: 16px;
      background: rgba(248, 113, 113, 0.08);
      border-radius: 10px;
      border: 1px solid rgba(248, 113, 113, 0.2);
      font-size: 13px;
      line-height: 1.5;
      color: rgba(255, 255, 255, 0.9);
    }
    .civilian-impact strong {
      color: var(--accent4);
    }

    /* Displaced Regions Section */
    .displaced-regions {
      grid-column: 1 / span 12;
      margin-top: 24px;
      padding: 20px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(192, 132, 252, 0.05), rgba(192, 132, 252, 0.02));
      border: 1px solid rgba(192, 132, 252, 0.1);
      position: relative;
      overflow: hidden;
    }
    .displaced-regions::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent3), transparent);
    }
    .displaced-regions h2 {
      margin: 0 0 16px 0;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .displaced-regions h2::before {
      content: 'üìç';
      font-size: 16px;
    }
    .region-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 12px;
    }
    .region-card {
      padding: 12px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.03);
      position: relative;
      overflow: hidden;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .region-card.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .region-card:hover {
      transform: translateY(-4px);
      background: rgba(255, 255, 255, 0.04);
      border-color: rgba(192, 132, 252, 0.2);
    }
    .region-name {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .region-name::before {
      content: '‚ñ∏';
      color: var(--accent3);
      font-size: 10px;
    }
    .region-value {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(90deg, var(--accent3), #a78bfa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.5px;
    }
    .region-total {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px dashed rgba(255, 255, 255, 0.05);
      text-align: center;
      font-size: 14px;
      color: var(--muted);
    }
    .total-value {
      font-size: 24px;
      font-weight: 800;
      color: var(--accent3);
      margin-top: 4px;
    }

    /* Region groups */
    .region-group {
      margin-bottom: 20px;
    }
    .region-group-title {
      font-size: 14px;
      color: var(--accent2);
      margin-bottom: 10px;
      padding-left: 8px;
      border-left: 3px solid var(--accent2);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }

    /* NEW: Methodology & Rates Section */
    .methodology {
      grid-column: 1 / span 12;
      margin-top: 32px;
      padding: 28px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(110, 231, 183, 0.05), rgba(110, 231, 183, 0.02));
      border: 1px solid rgba(110, 231, 183, 0.1);
      position: relative;
      overflow: hidden;
    }
    .methodology::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent1), transparent);
    }
    .methodology h2 {
      margin: 0 0 24px 0;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--accent1);
    }
    .methodology h2::before {
      content: 'üìä';
      font-size: 18px;
    }
    
    /* Formula Box */
    .formula-box {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 0px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.3s ease;
      opacity: 0;
      transform: translateY(20px);
      min-height: 200px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .formula-box.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .formula-box:hover {
      transform: translateY(-5px);
      background: rgba(110, 231, 183, 0.08);
      border-color: rgba(110, 231, 183, 0.2);
    }
    .formula-title {
      font-size: 15px;
      color: var(--accent1);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      line-height: 1.4;
    }
    .formula-title::before {
      content: 'Œ£';
      font-size: 14px;
      font-weight: bold;
    }
    
    /* Formula Layout */
    .formula-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }
    .formula-equation {
      font-size: 16px;
      font-weight: 500;
      text-align: center;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      font-family: 'Inter', monospace;
      min-width: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .fraction {
      display: inline-block;
      text-align: center;
      vertical-align: middle;
      margin: 0 8px;
    }
    .numerator {
      display: block;
      padding: 2px 12px;
      border-bottom: 2px solid var(--accent1);
    }
    .denominator {
      display: block;
      padding: 2px 12px;
    }
    .formula-equals {
      font-size: 24px;
      color: var(--accent1);
      font-weight: bold;
      margin: 0 10px;
    }
    .formula-result {
      font-size: 20px;
      font-weight: 800;
      color: var(--accent1);
      padding: 8px 16px;
      background: rgba(110, 231, 183, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(110, 231, 183, 0.2);
    }
    .formula-interpretation {
      font-size: 13px;
      line-height: 1.5;
      color: rgba(255, 255, 255, 0.8);
      padding: 12px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px;
      border-left: 3px solid var(--accent1);
    }
    
    /* Methodology Grid */
    .methodology-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 24px;
      margin-top: 24px;
    }


    .multiply-k {
      font-size: 14px;
      color: var(--accent1);
      margin-left: 8px;
      font-weight: 600;
      opacity: 0.9;
      align-self: center;
    }


    footer{margin-top:26px;color:var(--muted);font-size:13px;text-align:center}

    /* Animations */
    .fade-up{opacity:0;transform:translateY(12px);transition:all 650ms cubic-bezier(.2,.9,.32,1)}
    .in-view{opacity:1;transform:translateY(0)}

    /* Responsive */
    @media (max-width:900px){
      .grid{grid-template-columns:repeat(1,1fr)}
      .stats{order:2}
      .chart{order:1}
      .sections{grid-template-columns:1fr}
      .hero-stat{flex-direction:column;gap:8px;align-items:flex-start}
      .region-grid{grid-template-columns:repeat(2,1fr)}
      .death-stats-grid,
      .death-summary-grid,
      .key-stats-grid{grid-template-columns:1fr}
      .methodology-grid{grid-template-columns:1fr; gap: 20px}
      .formula-content{flex-direction:column;gap:12px}
      .formula-equation{min-width: auto; width: 100%; flex-direction: column; gap: 6px}
      .multiply-k{margin-left: 0; margin-top: 4px}
    }
    @media (max-width:600px){
      .region-grid{grid-template-columns:1fr}
    }

    /* small helpers */
    .muted{color:var(--muted)}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-size:12px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">LB</div>
        <div>
          <h1>Lebanon ‚Äî Conflict Impact Summary</h1>
          <p class="lead">Concise data snapshot (spring 2025) ‚Äî returns, damage, livelihoods, and social impact.</p>
        </div>
      </div>
      <div class="pill">Updated: Spring 2025</div>
    </header>

    <div class="grid">
      <div class="stats fade-up" data-ro="true">
        <div style="display:flex;align-items:center;justify-content:space-between;"> 
          <div>
            <div style="font-size:12px;color:var(--muted);">Returnees (IOM)</div>
            <div class="num" id="num-return">0</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:12px;color:var(--muted);">Remaining displaced</div>
            <div class="num" id="num-displaced">0</div>
          </div>
        </div>
        <div style="height:12px"></div>
        <div class="stat">
          <div>
            <div class="num" id="early-jan-return">0</div>
            <div class="label">Early Jan 2025 ‚Äî returned</div>
          </div>
          <div style="margin-left:auto;text-align:right">
            <div class="num" id="early-jan-rem">0</div>
            <div class="label">Early Jan 2025 ‚Äî remaining displaced</div>
          </div>
        </div>
        <div class="stat">
          <div>
            <div class="num" id="march-return">0</div>
            <div class="label">Mar 7, 2025 ‚Äî returned</div>
          </div>
          <div style="margin-left:auto;text-align:right">
            <div class="num" id="march-rem">0</div>
            <div class="label">Mar 7, 2025 ‚Äî remaining displaced</div>
          </div>
        </div>
        <div class="stat">
          <div>
            <div class="num" id="april-return">0</div>
            <div class="label">Apr 30, 2025 ‚Äî returned</div>
          </div>
          <div style="margin-left:auto;text-align:right">
            <div class="num" id="april-rem">0</div>
            <div class="label">Apr 30, 2025 ‚Äî remaining displaced</div>
          </div>
        </div>
      </div>

      <div class="chart fade-up" data-ro="true">
        <div class="timeline">
          <div class="time-card">
            <h3>Early January 2025</h3>
            <p class="muted">~869,000 returned; ~115,000 still displaced (incl. ~3,800 in collective sites).</p>
          </div>
          <div class="time-card">
            <h3>March 7, 2025</h3>
            <p class="muted">~954,000 returned; ~96,000 still displaced.</p>
          </div>
          <div class="time-card">
            <h3>April 30, 2025</h3>
            <p class="muted">~970,000 returned; ~90,000 still displaced.</p>
          </div>
        </div>
      </div>

      <div class="hero-stat fade-up" data-ro="true">
        <div>
          <div class="big" id="spring-return">0</div>
          <div class="sub">Returned by Spring 2025</div>
        </div>
        <div style="text-align:right">
          <div style="font-weight:700">90,000‚Äì120,000</div>
          <div class="sub">Estimated remaining displaced</div>
        </div>
      </div>


      <!-- Displaced People by Region Section -->
      <div class="displaced-regions fade-up" data-ro="true">
        <h2>Displaced Population by Region (Spring 2025)</h2>
        
        <div class="region-group">
          <div class="region-group-title">South Lebanon</div>
          <div class="region-grid" id="south-regions">
            <!-- South regions will be populated by JavaScript -->
          </div>
        </div>

        <div class="region-group">
          <div class="region-group-title">El Bekaa</div>
          <div class="region-grid" id="bekaa-regions">
            <!-- Bekaa regions will be populated by JavaScript -->
          </div>
        </div>

        <div class="region-group">
          <div class="region-group-title">Beirut & Mount Lebanon</div>
          <div class="region-grid" id="other-regions">
            <!-- Other regions will be populated by JavaScript -->
          </div>
        </div>

        <div class="region-total">
          Total Displaced Shown:
          <div class="total-value" id="total-displaced">0</div>
        </div>
      </div>

      <!-- Death Rates & Casualties Section -->
      <div class="death-rates fade-up" data-ro="true">
        <h2>Casualties & Death Rates</h2>
        
        <!-- Key Statistics -->
        <div class="key-stats-grid" id="death-key-stats">
          <!-- Populated by JavaScript -->
        </div>
        
        <!-- Summary Cards -->
        <div class="death-summary-grid">
          <div class="death-summary-card" id="card-lebanon">
            <h3>Lebanon Casualties</h3>
            <p>Lebanese government reports 2,720 people killed by Israel, mostly civilians. By mid-November 2024, Lebanon's Ministry of Public Health reported 3,583 total deaths, including 231 children. UNICEF confirms over 200 children killed.</p>
          </div>
          
          <div class="death-summary-card" id="card-israel">
            <h3>Israeli Military Losses</h3>
            <p>Israel reports 56 Israeli soldiers killed overall, with 9 killed in combat in southern Lebanon. 30 soldiers were wounded, 7 seriously. Hezbollah claims destroying 3 Israeli Merkava tanks and killing/wounding at least 20 elite Israeli soldiers.</p>
          </div>
          
          <div class="death-summary-card" id="card-hezbollah">
            <h3>Hezbollah Casualties</h3>
            <p>Israel reports 2,762 Hezbollah militants killed. Hezbollah leader reports 5,000 fighters killed and 13,000 wounded. In the pager explosions, 1,500 fighters were incapacitated, many blinded or lost hands. IDF claims 250+ fighters killed in south Lebanon.</p>
          </div>
        </div>
        
        <!-- Detailed Statistics -->
        <div class="death-stats-grid">
          <div class="death-stat-card" id="stat-sept">
            <div class="death-stat-value" data-value="42">0</div>
            <div class="death-stat-label">Killed in Pager Explosions</div>
            <div class="death-stat-desc">Sept 17-18: Thousands of Hezbollah pagers/walkie-talkies exploded in coordinated attacks, injuring 3,500+ including civilians.</div>
          </div>
          
          <div class="death-stat-card" id="stat-sept-week">
            <div class="death-stat-value" data-value="800">0</div>
            <div class="death-stat-label">Killed in First Week of Strikes</div>
            <div class="death-stat-desc">Sept 23 onwards: IDF airstrikes killed 800+ people in first week, with 5,000+ injured during same period.</div>
          </div>
          
          <div class="death-stat-card" id="stat-health">
            <div class="death-stat-value" data-value="40">0</div>
            <div class="death-stat-label">Paramedics & Firefighters Killed</div>
            <div class="death-stat-desc">Over 3 days: Lebanese Health Minister reported 40 emergency personnel killed, including Hezbollah-affiliated groups.</div>
          </div>
        </div>
        
        <!-- Timeline of Major Events -->
        <div class="death-timeline">
          <h3>Timeline of Major Casualty Events</h3>
          <div class="timeline-item" id="timeline-1">
            <div class="timeline-date">Mid-September 2024</div>
            <div class="timeline-desc">Israeli strikes on Lebanon killed at least 2,267 people and injured 11,022 (CNN tally).</div>
          </div>
          <div class="timeline-item" id="timeline-2">
            <div class="timeline-date">September 17-18, 2024</div>
            <div class="timeline-desc">Coordinated pager/walkie-talkie explosions killed 42, injured 3,500+, incapacitated 1,500 Hezbollah fighters.</div>
          </div>
          <div class="timeline-item" id="timeline-3">
            <div class="timeline-date">September 23, 2024</div>
            <div class="timeline-desc">IDF airstrikes began, killing 800+ in first week, injuring 5,000+.</div>
          </div>
          <div class="timeline-item" id="timeline-4">
            <div class="timeline-date">Recent Attacks</div>
            <div class="timeline-desc">Four health workers killed in Israeli drone strike near Marjayoun hospital. WHO reported 28 healthcare workers killed in past 24 hours.</div>
          </div>
        </div>
        
        <!-- Civilian Impact -->
        <div class="civilian-impact">
          <strong>Civilian Impact:</strong> The Lebanese Health Ministry states that most Lebanese killed by Israel are civilians. The conflict has resulted in significant loss of emergency and healthcare personnel, with multiple attacks on medical facilities and personnel.
        </div>
      </div>

      <!-- NEW: Methodology & Rates Section -->
<div class="methodology fade-up" data-ro="true">
  <h2>Methodology & Rates Calculation</h2>
  
  <div class="methodology-grid">
    
    <!-- Death Rate Formula -->
    <div class="formula-box" id="death-rate-formula">
      <div class="formula-title">Death Rate (per 1,000)</div>
      <div class="formula-content">
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">Number of deaths</span>
            <span class="denominator">Total population</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">3,583</span>
            <span class="denominator">4,800,000</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-result" data-value="0.746">0.746</div>
      </div>
      <div class="formula-interpretation">
        <strong>Interpretation:</strong> In 2024, the death rate in Lebanon was 0.746 per 1,000 residents.
      </div>
    </div>
    
    <!-- Total Displacement Rate Formula -->
    <div class="formula-box" id="total-displacement-formula">
      <div class="formula-title">Total Displacement Rate (per 1,000)</div>
      <div class="formula-content">
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">Total displaced people</span>
            <span class="denominator">Total population</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">97,613</span>
            <span class="denominator">4,800,000</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-result" data-value="20.33">20.33</div>
      </div>
      <div class="formula-interpretation">
        <strong>Interpretation:</strong> In 2024, the Lebanese displacement rate was 20.33 per 1,000 residents.
      </div>
    </div>
    
    <!-- Beirut & Mount Lebanon Displacement Rate -->
    <div class="formula-box" id="beirut-displacement-formula">
      <div class="formula-title">Beirut & Mount Lebanon Displacement Rate (per 1,000)</div>
      <div class="formula-content">
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">Displaced people (Beirut & Mount Lebanon)</span>
            <span class="denominator">Total population</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">25,645</span>
            <span class="denominator">4,800,000</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-result" data-value="5.34">5.34</div>
      </div>
      <div class="formula-interpretation">
        <strong>Interpretation:</strong> In 2024, the displacement rate for Beirut and Mount Lebanon district was 5.34 per 1,000 residents.
      </div>
    </div>
    
    <!-- Bekaa Displacement Rate -->
    <div class="formula-box" id="bekaa-displacement-formula">
      <div class="formula-title">Bekaa District Displacement Rate (per 1,000)</div>
      <div class="formula-content">
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">Displaced people (Bekaa)</span>
            <span class="denominator">Total population</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">762</span>
            <span class="denominator">4,800,000</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-result" data-value="0.15">0.15</div>
      </div>
      <div class="formula-interpretation">
        <strong>Interpretation:</strong> In 2024, the displacement rate for the Bekaa district was 0.15 per 1,000 residents.
      </div>
    </div>
    
    <!-- South Lebanon Displacement Rate -->
    <div class="formula-box" id="south-displacement-formula">
      <div class="formula-title">South Lebanon District Displacement Rate (per 1,000)</div>
      <div class="formula-content">
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">Displaced people (South Lebanon)</span>
            <span class="denominator">Total population</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-equation">
          <span class="fraction">
            <span class="numerator">71,206</span>
            <span class="denominator">4,800,000</span>
          </span>
          <span class="multiply-k">√ó 1,000</span>
        </div>
        <span class="formula-equals">=</span>
        <div class="formula-result" data-value="14.83">14.83</div>
      </div>
      <div class="formula-interpretation">
        <strong>Interpretation:</strong> In 2024, the displacement rate for the South Lebanon district was 14.83 per 1,000 residents.
      </div>
    </div>
    
  </div>
  
  <div class="formula-interpretation" style="margin-top: 20px; background: rgba(255,255,255,0.03);">
    <strong>Methodology Note:</strong> Rates are calculated per 1,000 residents using Lebanon's estimated population of 4,800,000. The death rate uses total reported deaths (3,583), while displacement rates use region-specific displacement data from spring 2025. This standardization allows for comparative analysis across regions.
  </div>
</div>

    <footer class="fade-up" data-ro="true">
      Data sources: IOM, DTM, World Bank, UN agencies, UNDP, UNESCWA, OCHA, Lebanese Ministry of Health, IDF reports, Hezbollah statements, CNN. (Summary for web presentation.)
    </footer>
  </div>

  <script>
    // Data (numbers) ‚Äî use integer values for counters
    const DATA = {
      earlyJanReturned: 869000,
      earlyJanRemaining: 115000,
      marchReturned: 954000,
      marchRemaining: 96000,
      aprilReturned: 970000,
      aprilRemaining: 90000,
      springReturned: 970000,
      
      // Displaced people data by region
      displacedByRegion: [
        // South Lebanon
        { region: "Saida", value: 13685, group: "south" },
        { region: "Sour", value: 25239, group: "south" },
        { region: "Jezzine", value: 102, group: "south" },
        { region: "Bent Jebeil", value: 6271, group: "south" },
        { region: "Nabatieh", value: 22817, group: "south" },
        { region: "Marjayoun", value: 1889, group: "south" },
        { region: "Hasbaya", value: 1203, group: "south" },
        
        // El Bekaa
        { region: "Zahle", value: 377, group: "bekaa" },
        { region: "Rachaya", value: 339, group: "bekaa" },
        { region: "West Bekaa", value: 46, group: "bekaa" },
        
        // Beirut & Mount Lebanon
        { region: "Beirut", value: 4954, group: "other" },
        { region: "Chouf", value: 4592, group: "other" },
        { region: "Al Metn", value: 4385, group: "other" },
        { region: "Baabda", value: 3081, group: "other" },
        { region: "Aley", value: 8633, group: "other" }
      ],
      
      // Death rates data
      deathRates: {
        israeliSoldiers: 56,
        hezbollahReportedByIsrael: 2762,
        lebaneseCivilians: 2720,
        pagerExplosionDeaths: 42,
        pagerExplosionInjured: 3500,
        pagerFightersIncapacitated: 1500,
        firstWeekDeaths: 800,
        firstWeekInjured: 5000,
        recentIsraeliSoldiers: 9,
        recentHezbollahClaims: 20,
        healthWorkers24h: 28,
        paramedics3days: 40,
        healthWorkersMarjayoun: 4,
        hezbollahFieldCommanders: 21,
        midSeptDeaths: 2267,
        midSeptInjured: 11022,
        midNovDeaths: 3583,
        childrenKilled: 231,
        hezbollahSelfReportedKilled: 5000,
        hezbollahSelfReportedWounded: 13000
      },
      
      // Methodology data
      methodology: {
        totalPopulation: 4800000,
        totalDeaths: 3583,
        totalDisplaced: 97613,
        beirutDisplaced: 25645,
        bekaaDisplaced: 762,
        southDisplaced: 71206,
        deathRate: 0.746,
        totalDisplacementRate: 20.33,
        beirutDisplacementRate: 5.34,
        bekaaDisplacementRate: 0.15,
        southDisplacementRate: 14.83
      }
    }

    // Simple count-up function
    function countUp(el, to, duration=1200){
      const start = 0;
      const range = to - start;
      const startTime = performance.now();
      function step(now){
        const elapsed = now - startTime;
        const t = Math.min(1, elapsed / duration);
        const eased = t*(2-t); // ease-out
        const val = Math.floor(start + eased * range);
        el.textContent = val.toLocaleString();
        if(t < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }
    
    // Count-up for decimal numbers (rates)
    function countUpDecimal(el, to, duration=1200) {
      const start = 0;
      const range = to - start;
      const startTime = performance.now();
      
      function step(now) {
        const elapsed = now - startTime;
        const t = Math.min(1, elapsed / duration);
        const eased = t*(2-t); // ease-out
        const val = start + eased * range;
        
        // Format to 2 decimal places
        if (to < 10) {
          el.textContent = val.toFixed(3);
        } else {
          el.textContent = val.toFixed(2);
        }
        
        if(t < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    // Function to create region cards
    function createRegionCards() {
      const southContainer = document.getElementById('south-regions');
      const bekaaContainer = document.getElementById('bekaa-regions');
      const otherContainer = document.getElementById('other-regions');
      
      let totalDisplaced = 0;
      
      DATA.displacedByRegion.forEach(item => {
        totalDisplaced += item.value;
        
        const card = document.createElement('div');
        card.className = 'region-card';
        card.innerHTML = `
          <div class="region-name">${item.region}</div>
          <div class="region-value" data-value="${item.value}">0</div>
        `;
        
        switch(item.group) {
          case 'south':
            southContainer.appendChild(card);
            break;
          case 'bekaa':
            bekaaContainer.appendChild(card);
            break;
          case 'other':
            otherContainer.appendChild(card);
            break;
        }
      });
      
      // Set total displaced
      document.getElementById('total-displaced').textContent = totalDisplaced.toLocaleString();
    }
    
    // Function to create key death statistics
    function createDeathKeyStats() {
      const container = document.getElementById('death-key-stats');
      const keyStats = [
        { value: DATA.deathRates.midNovDeaths, label: "Total Deaths in Lebanon" },
        { value: DATA.deathRates.israeliSoldiers, label: "Israeli Soldiers Killed" },
        { value: DATA.deathRates.hezbollahSelfReportedKilled, label: "Hezbollah Fighters Killed" },
        { value: DATA.deathRates.childrenKilled, label: "Children Killed" },
        { value: DATA.deathRates.midSeptInjured + DATA.deathRates.firstWeekInjured + DATA.deathRates.pagerExplosionInjured, label: "Total Reported Injuries" },
        { value: DATA.deathRates.paramedics3days + DATA.deathRates.healthWorkers24h + DATA.deathRates.healthWorkersMarjayoun, label: "Emergency Personnel Killed" }
      ];
      
      keyStats.forEach(stat => {
        const statEl = document.createElement('div');
        statEl.className = 'key-stat';
        statEl.innerHTML = `
          <div class="key-stat-value" data-value="${stat.value}">0</div>
          <div class="key-stat-label">${stat.label}</div>
        `;
        container.appendChild(statEl);
      });
    }
    
    // Animate methodology formulas
    function animateMethodology() {
      const formulaBoxes = document.querySelectorAll('.formula-box');
      formulaBoxes.forEach((box, index) => {
        setTimeout(() => {
          box.classList.add('visible');
          
          // Animate the result numbers
          const resultEl = box.querySelector('.formula-result');
          const value = parseFloat(resultEl.getAttribute('data-value'));
          countUpDecimal(resultEl, value, 1000);
        }, 200 + (index * 300));
      });
    }

    // Animate region cards with staggered delay
    function animateRegionCards() {
      const cards = document.querySelectorAll('.region-card');
      cards.forEach((card, index) => {
        // Staggered animation with delay
        setTimeout(() => {
          card.classList.add('visible');
          
          // Animate the number inside
          const valueEl = card.querySelector('.region-value');
          const value = parseInt(valueEl.getAttribute('data-value'));
          countUp(valueEl, value, 800);
          
        }, 100 + (index * 80)); // 80ms delay between each card
      });
    }
    
    // Animate death rates section
    function animateDeathRates() {
      // Animate summary cards
      const summaryCards = document.querySelectorAll('.death-summary-card');
      summaryCards.forEach((card, index) => {
        setTimeout(() => {
          card.classList.add('visible');
        }, 200 + (index * 200));
      });
      
      // Animate stat cards with numbers
      const statCards = document.querySelectorAll('.death-stat-card');
      statCards.forEach((card, index) => {
        setTimeout(() => {
          card.classList.add('visible');
          
          // Animate the number
          const valueEl = card.querySelector('.death-stat-value');
          const value = parseInt(valueEl.getAttribute('data-value'));
          countUp(valueEl, value, 1200);
        }, 600 + (index * 300));
      });
      
      // Animate key stats
      const keyStats = document.querySelectorAll('.key-stat');
      keyStats.forEach((stat, index) => {
        setTimeout(() => {
          stat.classList.add('visible');
          
          // Animate the number
          const valueEl = stat.querySelector('.key-stat-value');
          const value = parseInt(valueEl.getAttribute('data-value'));
          countUp(valueEl, value, 1000);
        }, 800 + (index * 150));
      });
      
      // Animate timeline items
      const timelineItems = document.querySelectorAll('.timeline-item');
      timelineItems.forEach((item, index) => {
        setTimeout(() => {
          item.classList.add('visible');
        }, 1000 + (index * 200));
      });
    }

    // populate elements
    document.getElementById('early-jan-return').textContent = '0';
    document.getElementById('early-jan-rem').textContent = '0';
    document.getElementById('march-return').textContent = '0';
    document.getElementById('march-rem').textContent = '0';
    document.getElementById('april-return').textContent = '0';
    document.getElementById('april-rem').textContent = '0';
    document.getElementById('num-return').textContent = '0';
    document.getElementById('num-displaced').textContent = '0';
    document.getElementById('spring-return').textContent = '0';
    
    // Create region cards and death stats
    createRegionCards();
    createDeathKeyStats();

    // IntersectionObserver to reveal and animate when in view
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        const el = entry.target;
        if(entry.isIntersecting){
          el.classList.add('in-view');
          if(el.dataset.ro === 'true'){
            // when stats container appears, start counters
            if(el.classList.contains('stats') || el.classList.contains('hero-stat') || el.classList.contains('chart')){
              // animate counters
              countUp(document.getElementById('early-jan-return'), DATA.earlyJanReturned, 5000);
              countUp(document.getElementById('early-jan-rem'), DATA.earlyJanRemaining, 5000);
              countUp(document.getElementById('march-return'), DATA.marchReturned, 5000);
              countUp(document.getElementById('march-rem'), DATA.marchRemaining, 5000);
              countUp(document.getElementById('april-return'), DATA.aprilReturned, 5000);
              countUp(document.getElementById('april-rem'), DATA.aprilRemaining, 5000);
              countUp(document.getElementById('num-return'), DATA.springReturned, 7000);
              countUp(document.getElementById('num-displaced'), 100000, 4800);
              countUp(document.getElementById('spring-return'), DATA.springReturned, 7000);
            }
            
            // When displaced regions section appears
            if(el.classList.contains('displaced-regions')) {
              setTimeout(animateRegionCards, 300);
            }
            
            // When death rates section appears
            if(el.classList.contains('death-rates')) {
              setTimeout(animateDeathRates, 300);
            }
            
            // When methodology section appears
            if(el.classList.contains('methodology')) {
              setTimeout(animateMethodology, 300);
            }
          }
          io.unobserve(el);
        }
      })
    },{threshold:0.12});

    document.querySelectorAll('.fade-up').forEach(el=>io.observe(el));

    // make entire page keyboard accessible: focus outline
    document.addEventListener('keyup', e=>{
      if(e.key === 'Tab') document.documentElement.style.scrollBehavior='smooth';
    })
  </script>
</body>
</html>
